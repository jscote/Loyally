(function (DomainObject, Entity) {
    'use strict';

    module.exports = function (%sRepository) {

        var _repository = %sRepository;

        this.getPersister = function () {
               return _repository.persister;
        };

        this.get%sByIdentity = function (identity) {
            return _repository.get%sByIdentity(identity);
        };

        this.create = function (parameters) {

        //TODO consider returning a promise instead
                var domainObject = new DomainObject(parameters);
                domainObject.state = Entity.EntityState.inserted;
                return domainObject;
        };

%s
    };

})(require(Injector.getBasePath() + '/domainObjects/%s'), require(Injector.getBasePath() + '/domainObjects/entity'));